SELECT             t.teritory_name AS territoryName,
                   z.teritory_name AS zoneName,
                   r.teritory_name AS routeName,
                   c.TRADE_LICENSE_NAME AS outletName,
                   c.CUSTOMER_NAME AS outletOwner,
                   NVL(c.MOBILE_NO,'N/A') AS outletMobile,
                   ba.br_team_team_id AS teamId,
                   bt.team_name AS teamName,
                   bu.user_name AS brUserName,
                   brep.name AS brName,
                   CASE
                       WHEN brep.br_designation = 3 THEN 'BR'
                   END AS brDesignation,
                   brep.contact_number AS brMobile,
                   ba.add_date_time AS addDate,
                   bc.customer_name AS customerName,
                   bc.age AS customerAge,
                   bcon.contact_number AS customerMobile,
                   bc.district AS district,
                   bc.thana AS thana,
                   bc.id AS brActivityConsumerId,
                   ba.is_repeat_contact AS isRepeatContact,
                   ba.ID AS brActivityId,
                   NVL(CASE
                       WHEN ba.using_brand = 19 THEN 'ESSE_SLIM'
                       WHEN ba.using_brand = 20 THEN 'MOND_SLIM'
                       WHEN ba.using_brand = 21 THEN 'ORIS_SLIM'
                       WHEN ba.using_brand = 22 THEN 'XSO_SLIM'
                       WHEN ba.using_brand = 23 THEN 'ORIS_NANO'
                       WHEN ba.using_brand = 24 THEN 'PATRON_NANO'
                       WHEN ba.using_brand = 17 THEN 'CAMEL'
                       WHEN ba.using_brand = 25 THEN 'JPGL'
                       WHEN ba.using_brand = 26 THEN 'B_H_L'
                       WHEN ba.using_brand = 27 THEN 'B_H_S'
                       WHEN ba.using_brand = 28 THEN 'MARLBORO'
                       WHEN ba.using_brand = 12 THEN 'LUCKY_STRIKE'
                       WHEN ba.using_brand = 35 THEN 'LUCKIES'
                       WHEN ba.using_brand = 36 THEN 'NAVY_OPTION'
                       WHEN ba.using_brand = 37 THEN 'CAMEL_PURPLE_BURST'
                       WHEN ba.using_brand = 38 THEN 'CAMEL_LEMON_BRUST'
                       WHEN ba.using_brand = 39 THEN 'CAMEL_BLUE_BRUST'
                       WHEN ba.using_brand = 8 THEN 'NAVY'
                       WHEN ba.using_brand = 10 THEN 'STAR'
                   END,'OTHERS') AS usingBrand,
                   p.product_name AS offeredBrand,
                   p.product_id AS offeredBrandProductId,
                   ba.contact_module AS contactModule,
                   CASE
                       WHEN ba.swapping_no >0 then 'Yes'
                       ELSE 'No'
                   END AS swappingStatus,
                   ba.swapping_no AS swapping,
                   CASE
                       WHEN ba.sampling_no >0 then 'Yes'
                       ELSE 'No'
                   END AS samplingStatus,
                   ba.sampling_no AS sampling,
                   case when ba.offered_brand IN (47,48,49,50) and vs.GIFT_ITEM_ID IN (17,35,49) and vs.product_quantity IN (5,10,20) then 'Yes' else 'No' end vaoStatus,
                   case when ba.offered_brand IN (47,48,49,50) and vs.product_quantity = 5 and vs.GIFT_ITEM_ID =17 then vs.quantity else 0 end vaoLig5s,
                case when ba.offered_brand IN (47,48,49,50) and vs.GIFT_ITEM_ID=49 and vs.product_quantity = 10 then vs.quantity else 0 end vaoBan10s,
                case when ba.offered_brand IN (47,48,49,50) and vs.GIFT_ITEM_ID=35 and vs.product_quantity = 10 then vs.quantity else 0 end vaoDeo10s,
                case when ba.offered_brand IN (47,48,49,50) and vs.GIFT_ITEM_ID=49 and vs.product_quantity = 20 then vs.quantity else 0 end vaoBan20s,
                case when ba.offered_brand IN (47,48,49,50) and vs.GIFT_ITEM_ID=35 and vs.product_quantity = 20 then vs.quantity else 0 end vaoDeo20s
            FROM bractivity ba
            JOIN teritory r ON r.id = ba.route_id
            JOIN teritory z ON z.id = r.parent_id
            JOIN teritory t ON t.id = z.parent_id
            JOIN teritory d ON d.id = t.parent_id
            JOIN bruser bu ON ba.br_user_id = bu.user_id
            JOIN brand_representative brep ON ba.br_user_id = brep.br_user_user_id
            JOIN brteam bt ON ba.br_team_team_id = bt.team_id
            JOIN consumer c ON c.id = ba.outlet_id
            JOIN bractivity_consumer bc ON ba.br_activity_consumer_id = bc.id
            JOIN bractivity_contact bcon ON bc.br_activity_contact_id = bcon.id
            JOIN product p ON ba.offered_brand = p.product_id
            AND  p.product_desc='Maxim'
            LEFT JOIN vao_sale vs ON vs.bractivity_id = ba.id
            WHERE d.id like :divisionId || '%'
            and   t.id like :teritoryId || '%'
            AND to_char(ba.target_date, 'dd-mm-yyyy') = :targetDate
            ORDER BY ba.id DESC